<!DOCTYPE html>
<html lang="en-us" itemscope itemtype="http://schema.org/WebPage">
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>Reflection in golang (3) - LittleDriver</title>
  

<meta name="renderer" content="webkit" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>

<meta name="MobileOptimized" content="width"/>
<meta name="HandheldFriendly" content="true"/>


<meta name="applicable-device" content="pc,mobile">

<meta name="theme-color" content="#f8f5ec" />
<meta name="msapplication-navbutton-color" content="#f8f5ec">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="#f8f5ec">

<meta name="mobile-web-app-capable" content="yes">

<meta name="author" content="xuran" />
  <meta name="description" content="前景提要 上一篇文章当中，主要以实现了一个display函数为主要内容，阐述了如何通过golang的reflect包将一个自定义类型的数据格式" />







<meta name="generator" content="Hugo 0.51" />


<link rel="canonical" href="http://littledriver.net/post/2017/03/11/reflection-in-golang-3/" />



<link rel="icon" href="/favicon.ico" />











<link rel="stylesheet" href="/sass/jane.min.f384a7fa4673433bc34e238c5074bb1303d90e5d5a29a2ffbaf61226ef213c29.css" integrity="sha256-84Sn&#43;kZzQzvDTiOMUHS7EwPZDl1aKaL/uvYSJu8hPCk=" media="screen">





<meta property="og:title" content="Reflection in golang (3)" />
<meta property="og:description" content="前景提要 上一篇文章当中，主要以实现了一个display函数为主要内容，阐述了如何通过golang的reflect包将一个自定义类型的数据格式" />
<meta property="og:type" content="article" />
<meta property="og:url" content="http://littledriver.net/post/2017/03/11/reflection-in-golang-3/" /><meta property="article:published_time" content="2017-03-11T15:53:31&#43;00:00"/>
<meta property="article:modified_time" content="2017-03-11T15:53:31&#43;00:00"/>

<meta itemprop="name" content="Reflection in golang (3)">
<meta itemprop="description" content="前景提要 上一篇文章当中，主要以实现了一个display函数为主要内容，阐述了如何通过golang的reflect包将一个自定义类型的数据格式">


<meta itemprop="datePublished" content="2017-03-11T15:53:31&#43;00:00" />
<meta itemprop="dateModified" content="2017-03-11T15:53:31&#43;00:00" />
<meta itemprop="wordCount" content="3775">



<meta itemprop="keywords" content="Golang," />
<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Reflection in golang (3)"/>
<meta name="twitter:description" content="前景提要 上一篇文章当中，主要以实现了一个display函数为主要内容，阐述了如何通过golang的reflect包将一个自定义类型的数据格式"/>

<!--[if lte IE 9]>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/classlist/1.1.20170427/classList.min.js"></script>
<![endif]-->

<!--[if lt IE 9]>
  <script src="https://cdn.jsdelivr.net/npm/html5shiv@3.7.3/dist/html5shiv.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/respond.js@1.4.2/dest/respond.min.js"></script>
<![endif]-->




</head>
<body>
  <div id="mobile-navbar" class="mobile-navbar">
  <div class="mobile-header-logo">
    <a href="/" class="logo">LittleDriver</a>
  </div>
  <div class="mobile-navbar-icon">
    <span></span>
    <span></span>
    <span></span>
  </div>
</div>
<nav id="mobile-menu" class="mobile-menu slideout-menu">
  <ul class="mobile-menu-list">
    <li class="mobile-menu-item">
        
          
          
            <a class="menu-item-link" href="http://littledriver.net/">Home</a>
          
        
      </li><li class="mobile-menu-item">
        
          
          
            <a class="menu-item-link" href="http://littledriver.net/categories/">Categories</a>
          
        
      </li><li class="mobile-menu-item">
        
          
          
            <a class="menu-item-link" href="http://littledriver.net/tags/">Tags</a>
          
        
      </li>
    
  </ul>
</nav>


  

  

  <header id="header" class="header container">
    <div class="logo-wrapper">
  <a href="/" class="logo">
    
      LittleDriver
    
  </a>
</div>

<nav class="site-navbar">
  <ul id="menu" class="menu">
    
    
        <li class="menu-item">
        
          
          
            <a class="menu-item-link" href="http://littledriver.net/">Home</a>
          

        

      </li>
    
        <li class="menu-item">
        
          
          
            <a class="menu-item-link" href="http://littledriver.net/categories/">Categories</a>
          

        

      </li>
    
        <li class="menu-item">
        
          
          
            <a class="menu-item-link" href="http://littledriver.net/tags/">Tags</a>
          

        

      </li>
    
    
  </ul>
</nav>

  </header>

  <div id="mobile-panel">
    <main id="main" class="main bg-llight">
      <div class="content-wrapper">
        <div id="content" class="content container">
          <article class="post bg-white">
    
    <header class="post-header">
      <h1 class="post-title">Reflection in golang (3)</h1>
      
      <div class="post-meta">
        <time datetime="2017-03-11" class="post-time">
          2017-03-11
        </time>
        <div class="post-category">
            <a href="http://littledriver.net/categories/%E5%B7%A5%E4%BD%9C%E4%BA%86%E4%B9%9F%E4%B8%8D%E8%83%BD%E6%94%BE%E6%9D%BE%E7%B3%BB%E5%88%97/"> 工作了也不能放松系列 </a>
            
          </div>
        

        
        

        
        
      </div>
    </header>

    
    

    
    <div class="post-content">
      <h1 id="前景提要">前景提要</h1>

<p>上一篇文章当中，主要以实现了一个display函数为主要内容，阐述了如何通过golang的reflect包将一个自定义类型的数据格式化输出，它类似于一个简洁版的fmt.Printf函数。但是这个函数只是简单的实现了从具体类型的数据到字符串的输出功能。在日常的工作中，我们时常要通过http/https请求调用一些第三方服务的接口，传输的数据不但需要保持一定的编码格式，还需要按照被调用服务接口接收数据的规范来构造我们的请求数据。</p>

<p>在使用golang的过程当中，一定少不了对encoding/json包当中的json.Marshal方法的使用，他接收一个interface值, 返回一个以ASN.1格式编码byte数组。 ASN.1是一套正式且公用的编码标准，使用json.Marshal对我们的数据进行编码之后，得到的结果就可以在进程间以及服务间进行传输。编码这件事，说白了，就是把我们准备好的数据通过一定的规则转换成另外一种表现形式，比如把十进制数字转换成二进制数据，我觉得这就是一种编码。再不理解的话，也可以想想莫斯密电码，应该很容易就明白了。</p>

<p>今天这篇文章，将会对上次我们实现的display函数进行再一次的扩展，使其能够具备数据编码的功能.</p>

<h1 id="encoding">Encoding</h1>

<p>golang的标准库内为我们提供了几种常见并且通用的编码格式，如，xml, json, asn.1等。熟悉lisp或者scheme的人肯定知道s-expression这种格式。仿照《The Go programing language》一书中的例子，我自己也实现了一个将普通数据编码成s-expression形式的函数。（由于注重的是反射的使用，所以在代码风格上面没有做过多的注意，各位看官勿喷）</p>

<p>在我实现的Encoding函数中，我主要处理了String, int, array, slice, struct, map, ptr等类型的数据编码，其余的如interface等类型，为了简单起见，我并没有对其做处理。编码的规范如下：</p>

<ol>
<li>数字的类型如int还是直接编码成对应的字符串表示。字符串类型也是一样</li>
<li>struct类型编码成（(fieldName fieldValue) (fieldName fieldValue) &hellip;）的形式</li>
<li>map类型编码成 ((keyName value), (keyName value) &hellip;)的形式</li>
<li>指针类型不做特殊处理，而是获取到其指向的变量之后，对这个变量编码。</li>
</ol>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><span class="lnt">  1
</span><span class="lnt">  2
</span><span class="lnt">  3
</span><span class="lnt">  4
</span><span class="lnt">  5
</span><span class="lnt">  6
</span><span class="lnt">  7
</span><span class="lnt">  8
</span><span class="lnt">  9
</span><span class="lnt"> 10
</span><span class="lnt"> 11
</span><span class="lnt"> 12
</span><span class="lnt"> 13
</span><span class="lnt"> 14
</span><span class="lnt"> 15
</span><span class="lnt"> 16
</span><span class="lnt"> 17
</span><span class="lnt"> 18
</span><span class="lnt"> 19
</span><span class="lnt"> 20
</span><span class="lnt"> 21
</span><span class="lnt"> 22
</span><span class="lnt"> 23
</span><span class="lnt"> 24
</span><span class="lnt"> 25
</span><span class="lnt"> 26
</span><span class="lnt"> 27
</span><span class="lnt"> 28
</span><span class="lnt"> 29
</span><span class="lnt"> 30
</span><span class="lnt"> 31
</span><span class="lnt"> 32
</span><span class="lnt"> 33
</span><span class="lnt"> 34
</span><span class="lnt"> 35
</span><span class="lnt"> 36
</span><span class="lnt"> 37
</span><span class="lnt"> 38
</span><span class="lnt"> 39
</span><span class="lnt"> 40
</span><span class="lnt"> 41
</span><span class="lnt"> 42
</span><span class="lnt"> 43
</span><span class="lnt"> 44
</span><span class="lnt"> 45
</span><span class="lnt"> 46
</span><span class="lnt"> 47
</span><span class="lnt"> 48
</span><span class="lnt"> 49
</span><span class="lnt"> 50
</span><span class="lnt"> 51
</span><span class="lnt"> 52
</span><span class="lnt"> 53
</span><span class="lnt"> 54
</span><span class="lnt"> 55
</span><span class="lnt"> 56
</span><span class="lnt"> 57
</span><span class="lnt"> 58
</span><span class="lnt"> 59
</span><span class="lnt"> 60
</span><span class="lnt"> 61
</span><span class="lnt"> 62
</span><span class="lnt"> 63
</span><span class="lnt"> 64
</span><span class="lnt"> 65
</span><span class="lnt"> 66
</span><span class="lnt"> 67
</span><span class="lnt"> 68
</span><span class="lnt"> 69
</span><span class="lnt"> 70
</span><span class="lnt"> 71
</span><span class="lnt"> 72
</span><span class="lnt"> 73
</span><span class="lnt"> 74
</span><span class="lnt"> 75
</span><span class="lnt"> 76
</span><span class="lnt"> 77
</span><span class="lnt"> 78
</span><span class="lnt"> 79
</span><span class="lnt"> 80
</span><span class="lnt"> 81
</span><span class="lnt"> 82
</span><span class="lnt"> 83
</span><span class="lnt"> 84
</span><span class="lnt"> 85
</span><span class="lnt"> 86
</span><span class="lnt"> 87
</span><span class="lnt"> 88
</span><span class="lnt"> 89
</span><span class="lnt"> 90
</span><span class="lnt"> 91
</span><span class="lnt"> 92
</span><span class="lnt"> 93
</span><span class="lnt"> 94
</span><span class="lnt"> 95
</span><span class="lnt"> 96
</span><span class="lnt"> 97
</span><span class="lnt"> 98
</span><span class="lnt"> 99
</span><span class="lnt">100
</span><span class="lnt">101
</span><span class="lnt">102
</span><span class="lnt">103
</span><span class="lnt">104
</span><span class="lnt">105
</span><span class="lnt">106
</span><span class="lnt">107
</span><span class="lnt">108
</span><span class="lnt">109
</span><span class="lnt">110
</span><span class="lnt">111
</span><span class="lnt">112
</span><span class="lnt">113
</span><span class="lnt">114
</span><span class="lnt">115
</span><span class="lnt">116
</span><span class="lnt">117
</span><span class="lnt">118
</span><span class="lnt">119
</span><span class="lnt">120
</span><span class="lnt">121
</span><span class="lnt">122
</span><span class="lnt">123
</span><span class="lnt">124
</span><span class="lnt">125
</span><span class="lnt">126
</span><span class="lnt">127
</span><span class="lnt">128
</span><span class="lnt">129
</span><span class="lnt">130
</span><span class="lnt">131
</span><span class="lnt">132
</span><span class="lnt">133
</span><span class="lnt">134
</span><span class="lnt">135
</span><span class="lnt">136
</span><span class="lnt">137
</span><span class="lnt">138
</span><span class="lnt">139
</span><span class="lnt">140
</span><span class="lnt">141
</span><span class="lnt">142
</span><span class="lnt">143
</span><span class="lnt">144
</span><span class="lnt">145
</span><span class="lnt">146
</span><span class="lnt">147
</span><span class="lnt">148
</span><span class="lnt">149
</span><span class="lnt">150
</span><span class="lnt">151
</span><span class="lnt">152
</span><span class="lnt">153
</span><span class="lnt">154
</span><span class="lnt">155
</span><span class="lnt">156
</span><span class="lnt">157
</span><span class="lnt">158
</span><span class="lnt">159
</span><span class="lnt">160
</span><span class="lnt">161
</span><span class="lnt">162
</span><span class="lnt">163
</span><span class="lnt">164
</span><span class="lnt">165
</span><span class="lnt">166
</span><span class="lnt">167
</span><span class="lnt">168
</span><span class="lnt">169
</span><span class="lnt">170
</span><span class="lnt">171
</span><span class="lnt">172
</span><span class="lnt">173
</span><span class="lnt">174
</span><span class="lnt">175
</span><span class="lnt">176
</span><span class="lnt">177
</span><span class="lnt">178
</span></pre></td>
<td class="lntd">
<pre class="chroma"><span class="kn">package</span> <span class="nx">main</span>

<span class="kn">import</span> <span class="p">(</span>
	<span class="s">&#34;bytes&#34;</span>
	<span class="s">&#34;fmt&#34;</span>
	<span class="s">&#34;reflect&#34;</span>
<span class="p">)</span>

<span class="kd">func</span> <span class="nf">Encode</span><span class="p">(</span><span class="nx">value</span> <span class="nx">reflect</span><span class="p">.</span><span class="nx">Value</span><span class="p">,</span> <span class="nx">buff</span> <span class="o">*</span><span class="nx">bytes</span><span class="p">.</span><span class="nx">Buffer</span><span class="p">)</span> <span class="p">(</span><span class="nx">err</span> <span class="kt">error</span><span class="p">)</span> <span class="p">{</span>
	<span class="k">switch</span> <span class="nx">value</span><span class="p">.</span><span class="nf">Kind</span><span class="p">()</span> <span class="p">{</span>
	<span class="k">case</span> <span class="nx">reflect</span><span class="p">.</span><span class="nx">Invalid</span><span class="p">:</span>
		<span class="nx">_</span><span class="p">,</span> <span class="nx">err</span> <span class="p">=</span> <span class="nx">buff</span><span class="p">.</span><span class="nf">Write</span><span class="p">([]</span><span class="nb">byte</span><span class="p">(</span><span class="s">&#34;nil&#34;</span><span class="p">))</span>
	<span class="k">case</span> <span class="nx">reflect</span><span class="p">.</span><span class="nx">Int</span><span class="p">,</span> <span class="nx">reflect</span><span class="p">.</span><span class="nx">Int8</span><span class="p">,</span> <span class="nx">reflect</span><span class="p">.</span><span class="nx">Int16</span><span class="p">,</span> <span class="nx">reflect</span><span class="p">.</span><span class="nx">Int32</span><span class="p">,</span> <span class="nx">reflect</span><span class="p">.</span><span class="nx">Int64</span><span class="p">:</span>
		<span class="nx">fmt</span><span class="p">.</span><span class="nf">Fprintf</span><span class="p">(</span><span class="nx">buff</span><span class="p">,</span> <span class="s">&#34;%d&#34;</span><span class="p">,</span> <span class="nx">value</span><span class="p">.</span><span class="nf">Int</span><span class="p">())</span>
	<span class="k">case</span> <span class="nx">reflect</span><span class="p">.</span><span class="nx">String</span><span class="p">:</span>
		<span class="nx">fmt</span><span class="p">.</span><span class="nf">Fprintf</span><span class="p">(</span><span class="nx">buff</span><span class="p">,</span> <span class="s">&#34;%q&#34;</span><span class="p">,</span> <span class="nx">value</span><span class="p">.</span><span class="nf">String</span><span class="p">())</span>
	<span class="k">case</span> <span class="nx">reflect</span><span class="p">.</span><span class="nx">Ptr</span><span class="p">:</span>
		<span class="nx">err</span> <span class="p">=</span> <span class="nf">Encode</span><span class="p">(</span><span class="nx">value</span><span class="p">.</span><span class="nf">Elem</span><span class="p">(),</span> <span class="nx">buff</span><span class="p">)</span>
	<span class="k">case</span> <span class="nx">reflect</span><span class="p">.</span><span class="nx">Array</span><span class="p">,</span> <span class="nx">reflect</span><span class="p">.</span><span class="nx">Slice</span><span class="p">:</span>
		<span class="nx">_</span><span class="p">,</span> <span class="nx">err</span> <span class="p">=</span> <span class="nx">buff</span><span class="p">.</span><span class="nf">WriteString</span><span class="p">(</span><span class="s">&#34;(&#34;</span><span class="p">)</span>
		<span class="k">if</span> <span class="nx">err</span> <span class="o">!=</span> <span class="kc">nil</span> <span class="p">{</span>
			<span class="k">return</span>
		<span class="p">}</span>

		<span class="k">for</span> <span class="nx">i</span> <span class="o">:=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="p">&lt;</span> <span class="nx">value</span><span class="p">.</span><span class="nf">Len</span><span class="p">();</span> <span class="nx">i</span><span class="o">++</span> <span class="p">{</span>
			<span class="nx">err</span> <span class="p">=</span> <span class="nf">Encode</span><span class="p">(</span><span class="nx">value</span><span class="p">.</span><span class="nf">Index</span><span class="p">(</span><span class="nx">i</span><span class="p">),</span> <span class="nx">buff</span><span class="p">)</span>
			<span class="k">if</span> <span class="nx">err</span> <span class="o">!=</span> <span class="kc">nil</span> <span class="p">{</span>
				<span class="k">return</span>
			<span class="p">}</span>

			<span class="k">if</span> <span class="nx">i</span> <span class="o">!=</span> <span class="nx">value</span><span class="p">.</span><span class="nf">Len</span><span class="p">()</span><span class="o">-</span><span class="mi">1</span> <span class="p">{</span>
				<span class="nx">_</span><span class="p">,</span> <span class="nx">err</span> <span class="p">=</span> <span class="nx">buff</span><span class="p">.</span><span class="nf">WriteString</span><span class="p">(</span><span class="s">&#34; &#34;</span><span class="p">)</span>
				<span class="k">if</span> <span class="nx">err</span> <span class="o">!=</span> <span class="kc">nil</span> <span class="p">{</span>
					<span class="k">return</span>
				<span class="p">}</span>
			<span class="p">}</span>
		<span class="p">}</span>

		<span class="nx">_</span><span class="p">,</span> <span class="nx">err</span> <span class="p">=</span> <span class="nx">buff</span><span class="p">.</span><span class="nf">WriteString</span><span class="p">(</span><span class="s">&#34;)&#34;</span><span class="p">)</span>
	<span class="k">case</span> <span class="nx">reflect</span><span class="p">.</span><span class="nx">Struct</span><span class="p">:</span>
		<span class="nx">_</span><span class="p">,</span> <span class="nx">err</span> <span class="p">=</span> <span class="nx">buff</span><span class="p">.</span><span class="nf">WriteString</span><span class="p">(</span><span class="s">&#34;(&#34;</span><span class="p">)</span>
		<span class="k">if</span> <span class="nx">err</span> <span class="o">!=</span> <span class="kc">nil</span> <span class="p">{</span>
			<span class="k">return</span>
		<span class="p">}</span>

		<span class="k">for</span> <span class="nx">j</span> <span class="o">:=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">j</span> <span class="p">&lt;</span> <span class="nx">value</span><span class="p">.</span><span class="nf">NumField</span><span class="p">();</span> <span class="nx">j</span><span class="o">++</span> <span class="p">{</span>
			<span class="k">if</span> <span class="nx">j</span> <span class="p">&gt;</span> <span class="mi">0</span> <span class="p">{</span>
				<span class="nx">_</span><span class="p">,</span> <span class="nx">err</span> <span class="p">=</span> <span class="nx">buff</span><span class="p">.</span><span class="nf">WriteString</span><span class="p">(</span><span class="s">&#34; &#34;</span><span class="p">)</span>
				<span class="k">if</span> <span class="nx">err</span> <span class="o">!=</span> <span class="kc">nil</span> <span class="p">{</span>
					<span class="k">return</span>
				<span class="p">}</span>
			<span class="p">}</span>

			<span class="nx">_</span><span class="p">,</span> <span class="nx">err</span> <span class="p">=</span> <span class="nx">buff</span><span class="p">.</span><span class="nf">WriteString</span><span class="p">(</span><span class="s">&#34;(&#34;</span><span class="p">)</span>
			<span class="k">if</span> <span class="nx">err</span> <span class="o">!=</span> <span class="kc">nil</span> <span class="p">{</span>
				<span class="k">return</span>
			<span class="p">}</span>

			<span class="nx">_</span><span class="p">,</span> <span class="nx">err</span> <span class="p">=</span> <span class="nx">buff</span><span class="p">.</span><span class="nf">WriteString</span><span class="p">(</span><span class="nx">value</span><span class="p">.</span><span class="nf">Type</span><span class="p">().</span><span class="nf">Field</span><span class="p">(</span><span class="nx">j</span><span class="p">).</span><span class="nx">Name</span><span class="p">)</span>
			<span class="k">if</span> <span class="nx">err</span> <span class="o">!=</span> <span class="kc">nil</span> <span class="p">{</span>
				<span class="k">return</span>
			<span class="p">}</span>

			<span class="nx">_</span><span class="p">,</span> <span class="nx">err</span> <span class="p">=</span> <span class="nx">buff</span><span class="p">.</span><span class="nf">WriteString</span><span class="p">(</span><span class="s">&#34; &#34;</span><span class="p">)</span>
			<span class="k">if</span> <span class="nx">err</span> <span class="o">!=</span> <span class="kc">nil</span> <span class="p">{</span>
				<span class="k">return</span>

			<span class="p">}</span>

			<span class="nx">err</span> <span class="p">=</span> <span class="nf">Encode</span><span class="p">(</span><span class="nx">value</span><span class="p">.</span><span class="nf">Field</span><span class="p">(</span><span class="nx">j</span><span class="p">),</span> <span class="nx">buff</span><span class="p">)</span>
			<span class="k">if</span> <span class="nx">err</span> <span class="o">!=</span> <span class="kc">nil</span> <span class="p">{</span>
				<span class="k">return</span>
			<span class="p">}</span>

			<span class="nx">_</span><span class="p">,</span> <span class="nx">err</span> <span class="p">=</span> <span class="nx">buff</span><span class="p">.</span><span class="nf">WriteString</span><span class="p">(</span><span class="s">&#34;)&#34;</span><span class="p">)</span>
			<span class="k">if</span> <span class="nx">err</span> <span class="o">!=</span> <span class="kc">nil</span> <span class="p">{</span>
				<span class="k">return</span>
			<span class="p">}</span>
		<span class="p">}</span>

		<span class="nx">_</span><span class="p">,</span> <span class="nx">err</span> <span class="p">=</span> <span class="nx">buff</span><span class="p">.</span><span class="nf">WriteString</span><span class="p">(</span><span class="s">&#34;)&#34;</span><span class="p">)</span>
		<span class="k">if</span> <span class="nx">err</span> <span class="o">!=</span> <span class="kc">nil</span> <span class="p">{</span>
			<span class="k">return</span>
		<span class="p">}</span>

	<span class="k">case</span> <span class="nx">reflect</span><span class="p">.</span><span class="nx">Map</span><span class="p">:</span>
		<span class="nx">_</span><span class="p">,</span> <span class="nx">err</span> <span class="p">=</span> <span class="nx">buff</span><span class="p">.</span><span class="nf">WriteString</span><span class="p">(</span><span class="s">&#34;(&#34;</span><span class="p">)</span>
		<span class="k">if</span> <span class="nx">err</span> <span class="o">!=</span> <span class="kc">nil</span> <span class="p">{</span>
			<span class="k">return</span>
		<span class="p">}</span>

		<span class="k">for</span> <span class="nx">j</span><span class="p">,</span> <span class="nx">k</span> <span class="o">:=</span> <span class="k">range</span> <span class="nx">value</span><span class="p">.</span><span class="nf">MapKeys</span><span class="p">()</span> <span class="p">{</span>
			<span class="k">if</span> <span class="nx">j</span> <span class="p">&gt;</span> <span class="mi">0</span> <span class="p">{</span>
				<span class="nx">_</span><span class="p">,</span> <span class="nx">err</span> <span class="p">=</span> <span class="nx">buff</span><span class="p">.</span><span class="nf">WriteString</span><span class="p">(</span><span class="s">&#34; &#34;</span><span class="p">)</span>
				<span class="k">if</span> <span class="nx">err</span> <span class="o">!=</span> <span class="kc">nil</span> <span class="p">{</span>
					<span class="k">return</span>
				<span class="p">}</span>
			<span class="p">}</span>

			<span class="nx">_</span><span class="p">,</span> <span class="nx">err</span> <span class="p">=</span> <span class="nx">buff</span><span class="p">.</span><span class="nf">WriteString</span><span class="p">(</span><span class="s">&#34;(&#34;</span><span class="p">)</span>
			<span class="k">if</span> <span class="nx">err</span> <span class="o">!=</span> <span class="kc">nil</span> <span class="p">{</span>
				<span class="k">return</span>
			<span class="p">}</span>

			<span class="nx">err</span> <span class="p">=</span> <span class="nf">Encode</span><span class="p">(</span><span class="nx">k</span><span class="p">,</span> <span class="nx">buff</span><span class="p">)</span>
			<span class="k">if</span> <span class="nx">err</span> <span class="o">!=</span> <span class="kc">nil</span> <span class="p">{</span>
				<span class="k">return</span>
			<span class="p">}</span>

			<span class="nx">_</span><span class="p">,</span> <span class="nx">err</span> <span class="p">=</span> <span class="nx">buff</span><span class="p">.</span><span class="nf">WriteString</span><span class="p">(</span><span class="s">&#34; &#34;</span><span class="p">)</span>
			<span class="k">if</span> <span class="nx">err</span> <span class="o">!=</span> <span class="kc">nil</span> <span class="p">{</span>
				<span class="k">return</span>

			<span class="p">}</span>

			<span class="nx">err</span> <span class="p">=</span> <span class="nf">Encode</span><span class="p">(</span><span class="nx">value</span><span class="p">.</span><span class="nf">MapIndex</span><span class="p">(</span><span class="nx">k</span><span class="p">),</span> <span class="nx">buff</span><span class="p">)</span>
			<span class="k">if</span> <span class="nx">err</span> <span class="o">!=</span> <span class="kc">nil</span> <span class="p">{</span>
				<span class="k">return</span>
			<span class="p">}</span>

			<span class="nx">_</span><span class="p">,</span> <span class="nx">err</span> <span class="p">=</span> <span class="nx">buff</span><span class="p">.</span><span class="nf">WriteString</span><span class="p">(</span><span class="s">&#34;)&#34;</span><span class="p">)</span>
			<span class="k">if</span> <span class="nx">err</span> <span class="o">!=</span> <span class="kc">nil</span> <span class="p">{</span>
				<span class="k">return</span>
			<span class="p">}</span>
		<span class="p">}</span>

		<span class="nx">_</span><span class="p">,</span> <span class="nx">err</span> <span class="p">=</span> <span class="nx">buff</span><span class="p">.</span><span class="nf">WriteString</span><span class="p">(</span><span class="s">&#34;)&#34;</span><span class="p">)</span>
		<span class="k">if</span> <span class="nx">err</span> <span class="o">!=</span> <span class="kc">nil</span> <span class="p">{</span>
			<span class="k">return</span>
		<span class="p">}</span>

	<span class="k">default</span><span class="p">:</span>
		<span class="nx">fmt</span><span class="p">.</span><span class="nf">Fprintf</span><span class="p">(</span><span class="nx">buff</span><span class="p">,</span> <span class="s">&#34;%s:%s&#34;</span><span class="p">,</span> <span class="s">&#34;unsupport type&#34;</span><span class="p">,</span> <span class="nx">value</span><span class="p">.</span><span class="nf">Kind</span><span class="p">())</span>
	<span class="p">}</span>

	<span class="k">return</span>
<span class="p">}</span>

<span class="kd">type</span> <span class="nx">B</span> <span class="kd">struct</span> <span class="p">{</span>
	<span class="nx">Fuck</span> <span class="kt">string</span> <span class="s">`json:&#34;fuck&#34;`</span>
	<span class="nx">You</span>  <span class="kt">int</span>    <span class="s">`json:&#34;you&#34;`</span>
<span class="p">}</span>

<span class="kd">type</span> <span class="nx">A</span> <span class="kd">struct</span> <span class="p">{</span>
	<span class="nx">Domain</span>   <span class="kt">string</span>            <span class="s">`json:&#34;domain&#34;`</span>
	<span class="nx">Cache</span>    <span class="p">[]</span><span class="kt">string</span>          <span class="s">`json:&#34;cache&#34;`</span>
	<span class="nx">CdnState</span> <span class="kd">map</span><span class="p">[</span><span class="kt">string</span><span class="p">]</span><span class="kt">string</span> <span class="s">`json:&#34;cdnState&#34;`</span>
	<span class="nx">Time</span>     <span class="kt">int</span>               <span class="s">`json:&#34;time&#34;`</span>
	<span class="nx">B</span>        <span class="s">`json:,inline`</span>
<span class="p">}</span>

<span class="kd">func</span> <span class="nf">main</span><span class="p">()</span> <span class="p">{</span>
	<span class="nx">b</span> <span class="o">:=</span> <span class="nx">B</span><span class="p">{</span>
		<span class="nx">Fuck</span><span class="p">:</span> <span class="s">&#34;fff&#34;</span><span class="p">,</span>
		<span class="nx">You</span><span class="p">:</span>  <span class="mi">3</span><span class="p">,</span>
	<span class="p">}</span>

	<span class="nx">obj</span> <span class="o">:=</span> <span class="nx">A</span><span class="p">{</span>
		<span class="nx">Domain</span><span class="p">:</span> <span class="s">&#34;hahah.com&#34;</span><span class="p">,</span>
		<span class="nx">Cache</span><span class="p">:</span>  <span class="p">[]</span><span class="kt">string</span><span class="p">{</span><span class="s">&#34;1&#34;</span><span class="p">,</span> <span class="s">&#34;2&#34;</span><span class="p">,</span> <span class="s">&#34;3&#34;</span><span class="p">},</span>
		<span class="nx">CdnState</span><span class="p">:</span> <span class="kd">map</span><span class="p">[</span><span class="kt">string</span><span class="p">]</span><span class="kt">string</span><span class="p">{</span>
			<span class="s">&#34;ws&#34;</span><span class="p">:</span> <span class="s">&#34;success&#34;</span><span class="p">,</span>
			<span class="s">&#34;tc&#34;</span><span class="p">:</span> <span class="s">&#34;success&#34;</span><span class="p">,</span>
		<span class="p">},</span>
		<span class="nx">Time</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span>
		<span class="nx">B</span><span class="p">:</span>    <span class="nx">b</span><span class="p">,</span>
	<span class="p">}</span>

	<span class="nx">buff</span> <span class="o">:=</span> <span class="nx">bytes</span><span class="p">.</span><span class="nx">Buffer</span><span class="p">{}</span>
	<span class="nx">err</span> <span class="o">:=</span> <span class="nf">Encode</span><span class="p">(</span><span class="nx">reflect</span><span class="p">.</span><span class="nf">ValueOf</span><span class="p">(</span><span class="nx">obj</span><span class="p">),</span> <span class="o">&amp;</span><span class="nx">buff</span><span class="p">)</span>
	<span class="k">if</span> <span class="nx">err</span> <span class="o">!=</span> <span class="kc">nil</span> <span class="p">{</span>
		<span class="nx">fmt</span><span class="p">.</span><span class="nf">Printf</span><span class="p">(</span><span class="s">&#34;Error: %+v&#34;</span><span class="p">,</span> <span class="nx">err</span><span class="p">)</span>
		<span class="k">return</span>
	<span class="p">}</span>

	<span class="nx">fmt</span><span class="p">.</span><span class="nf">Printf</span><span class="p">(</span><span class="s">&#34;%+v\n&#34;</span><span class="p">,</span> <span class="nb">string</span><span class="p">(</span><span class="nx">buff</span><span class="p">.</span><span class="nf">Bytes</span><span class="p">()))</span>
	<span class="k">return</span>
<span class="p">}</span></pre></td></tr></table>
</div>
</div>
<p>上述代码的输出结果为:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></pre></td>
<td class="lntd">
<pre class="chroma">👉  go run encode.go
((Domain &#34;hahah.com&#34;) (Cache (&#34;1&#34; &#34;2&#34; &#34;3&#34;)) (CdnState ((&#34;tc&#34; &#34;success&#34;) (&#34;ws&#34; &#34;success&#34;))) (Time 2) (B ((Fuck &#34;fff&#34;) (You 3))))
	</pre></td></tr></table>
</div>
</div>
<p>可以看出，Encoding函数已经简单的将普通数据类型的数据编码成了s-expression的形式。其实编码的格式并不一定要局限于一些目前公认标准的格式，我们也完全可以定义一套自己的规则。只要这套规则在编码和解码的过程中都能够保证数据的完整性和正确性即可。</p>

<h1 id="set-value">Set value</h1>

<p>之前的几篇关于反射的文章，甚至是这一篇文章，到此为止，在代码上面的实现以及对反射的讲解都停留在观察的层面上，也就是我们仅仅是把一个普通数据类型的值通过反射更进一步的获取他们信息，如类型，值等等。然后可以通过一些手段格式化输出他们。实际上，之前几篇文章的重点，并不在于使用reflect包实现一些具体的功能，而是在向大家突出，利用reflect几乎可以处理所有现在的以及未来的数据类型。当你把普通的数据类型通过reflect.ValueOf转换成reflect.Value类型值的时候，你可以以他为起点去做任何事情。之前实现的格式化输出，以及上面实现的编码功能。那么接下来我们就来了解一下，如何通过reflet包来更改一些未知的数据类型的值。</p>

<h2 id="从变量说起">从变量说起</h2>

<p>大家都知道，编程中最常见的两个概念就是变量和常量。顾名思义，变量是可以改变的，常量是恒久不变的。变量为什么可以改变呢？因为变量本身就是一个被名字标识的内存空间，它是可寻址的。只要一个东西是可寻址的，那么我们就可以通过地址在内存中找到他的位置，然后修改它内存空间中所保存的内容。这其实也就是我们常说的给变量赋值的过程。</p>

<p>对于reflect.Value值来说，它和interface一样，本身可以接受任何类型的数据。那么任意reflect.Value的值都可以像变量一样随意的更改么？我们写一个demo试试就知道了</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span><span class="lnt">9
</span></pre></td>
<td class="lntd">
<pre class="chroma">	a := 2
	x := reflect.ValueOf(a)
	fmt.Println(x.CanSet())  //false

	y := reflect.ValueOf(&amp;a)
	fmt.Println(y.CanSet())  //false

	z := y.Elem()
	fmt.Println(z.CanSet()  //true</pre></td></tr></table>
</div>
</div>
<p>通过调用reflect.Value.CanSet方法，根据其返回的结果是true还是false就可以确定一个reflect.Value值是不是可以改变的。 x在调用的时候返回了false,这是因为在构造x的时候，使用的是a这个变量内存储的值2，但是它自己并没有申请内存来存这个值. y也同样是这样，虽然它是通过a变量的地址值来构造的。事实上，任何通过reflect.ValueOf构造出来的reflect.Value都是不可寻址的，也就是说，我们只是copy了一份值来显示，并不能去改动他。</p>

<p>但是当我们对y调用Elem方法得到z，z却是一个可以改变的值。这是为什么呢？首先y是通过一个指针的值来构造的，其内存存储的是a这个变量的内存地址。调用Elem()方法，得到的是这个地址指向的内存空间，也就是a这个变量的地址空间。赋值给z也并没有切断y所指向的内存空间与a的联系，仅仅是给这块空间起了一个别名。</p>

<p>reflect包中还有一个方法叫做CanAddr。它的定义是这样的：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><span class="lnt">1
</span></pre></td>
<td class="lntd">
<pre class="chroma">CanAddr reports whether the value&#39;s address can be obtained with Addr. Such values are called addressable. A value is addressable if it is an element of a slice, an element of an addressable array, a field of an addressable struct, or the result of dereferencing a pointer. If CanAddr returns false, calling Addr will panic</pre></td></tr></table>
</div>
</div>
<p>它的功能是可以判断出一个reflect.Value是否是可寻址的。在它的描述当中也指出了，slice或者一个可寻址数组中的一个元素，或者一个可寻址的结构体的一个属性，甚至是对一个指针解引用的结果都是属于可寻址的。通过这几个例子我们可以看出，一个可寻址的reflect.Value都是需要通过一个指针指向某块内存的地址来间接获取到的。比如说，s := string[]{&ldquo;1&rdquo;, &ldquo;2&rdquo;}, reflect.ValueOf(s)是不可寻址的，它只是通过这个slice底层引用数组的起始地址构造了一个reflect.Value值。但是这时我通过调用reflect.ValueOf(s).Index(0)，就可以得到一个可寻址的值。因为通通过reflect.ValueOf得到了slice引用的底层数组的起始地址，然后通过index方法计算了内存的偏移量，就得到了在这段连续内存当中第一个元素的内存空间，即一个可寻址的值。所以说，在reflect当中，想要拿到一个可寻址值，首先要得到这个可寻址值所在的内存空间的地址。</p>

<h2 id="更新变量">更新变量</h2>

<p>当我们想要更新一个reflect.Value所引用的变量的值时，可以通过Set方法来做到。</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></pre></td>
<td class="lntd">
<pre class="chroma">	x := []int{1,2}
	z := reflect.ValueOf(x).Index(0) //get an addressable reflectValue
	z.Set(reflect.ValueOf(3)) // update value</pre></td></tr></table>
</div>
</div>
<p>需要注意的是，在调用Set方法进行赋值操作的时候，reflect包会像普通数据类型的赋值操作一样，检查赋值的合法性。比如z标识的可寻址值是一个int类型的，如果此时在调用set方法的时候，赋值给其一个int64类型的值就会导致panic。所以在使用set之前，我们必须保证我们将要给某个变量赋的值是它能够接受的。但是Set方法有一些变体，如SetInt, SetUint等.只要调用这些函数的值是有符号整数类型甚至是其底层的数据类型符合以上的条件，setInt等方法无论接收多大的数值都会通过截断的方式，构造出一个调用这个函数的值能接受的结果并赋值给它。</p>

<p>在第二篇文章中我们实现的格式化输出任意数据类型值的程序中，如果你仔细调试就会发现，如果输出的是一个struct类型的变量，那么其内部不可导出的field也可以被找到并且输出。我们可以通过Field或者FieldByName方法来获取struct类型值当中的某一个field，如果获取的是一个不可导出的field，那么对这个结果调用set类的修改方法会导致panic。这是一个特例，struct结构体内的不可导出field是可寻址的，但是是不可修改的。</p>

<h1 id="本文代码">本文代码</h1>

<p><a href="https://github.com/fengzixu/golangLearning/blob/master/reflect/encode.go">点这里</a></p>
    </div>

    
    

    
    

    <footer class="post-footer">
      <div class="post-tags">
          <a href="http://littledriver.net/tags/golang/">Golang</a>
          
        </div>

      
      <nav class="post-nav">
        
          <a class="prev" href="/post/2017/03/12/reflection-in-golang-4/">
            
            <i class="iconfont">
              <svg  class="icon" viewBox="0 0 1024 1024" version="1.1"
  xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"
  width="18" height="18">
  <path d="M691.908486 949.511495l75.369571-89.491197c10.963703-12.998035 10.285251-32.864502-1.499144-44.378743L479.499795 515.267417 757.434875 204.940602c11.338233-12.190647 11.035334-32.285311-0.638543-44.850487l-80.46666-86.564541c-11.680017-12.583596-30.356378-12.893658-41.662889-0.716314L257.233596 494.235404c-11.332093 12.183484-11.041474 32.266891 0.657986 44.844348l80.46666 86.564541c1.772366 1.910513 3.706415 3.533476 5.750981 4.877077l306.620399 321.703933C662.505829 963.726242 680.945807 962.528973 691.908486 949.511495z"></path>
</svg>

            </i>
            <span class="prev-text nav-default">Reflection in golang (4)</span>
            <span class="prev-text nav-mobile">Prev</span>
          </a>
        
          <a class="next" href="/post/2017/03/09/reflection-in-golang-2/">
            <span class="next-text nav-default">Reflection in golang (2)</span>
            <span class="prev-text nav-mobile">Next</span>
            
            <i class="iconfont">
              <svg class="icon" viewBox="0 0 1024 1024" version="1.1"
  xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"
  width="18" height="18">
  <path d="M332.091514 74.487481l-75.369571 89.491197c-10.963703 12.998035-10.285251 32.864502 1.499144 44.378743l286.278095 300.375162L266.565125 819.058374c-11.338233 12.190647-11.035334 32.285311 0.638543 44.850487l80.46666 86.564541c11.680017 12.583596 30.356378 12.893658 41.662889 0.716314l377.434212-421.426145c11.332093-12.183484 11.041474-32.266891-0.657986-44.844348l-80.46666-86.564541c-1.772366-1.910513-3.706415-3.533476-5.750981-4.877077L373.270379 71.774697C361.493148 60.273758 343.054193 61.470003 332.091514 74.487481z"></path>
</svg>

            </i>
          </a>
      </nav>
    </footer>
  </article>

  
  

  
  

  

  

  <div class="disqus-comment">
  <div class="disqus-button" id="load_disqus" onclick="load_disqus()">
    Show Disqus Comments
  </div>
  <div id="disqus_thread"></div>
  <script type="text/javascript">
    var disqus_config = function () {
      this.page.url = "http://littledriver.net/post/2017/03/11/reflection-in-golang-3/";
    };
    function load_disqus() {
      
      
      if (window.location.hostname === 'localhost') return;

      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      var disqus_shortname = 'fengzixu';
      dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);

      $('#load_disqus').remove();
    };
  </script>
  <noscript>Please enable JavaScript to view the
    <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a>
  </noscript>
  
  </div>
  
    



        </div>
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="social-links">
  
  
    <a href="mailto:hnustphoenix@email.com" rel="me noopener" class="iconfont"
      title="email" >
      <svg class="icon" viewBox="0 0 1451 1024" version="1.1"
  xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"
  width="36" height="36">
  <path d="M664.781909 681.472759 0 97.881301C0 3.997201 71.046997 0 71.046997 0L474.477909 0 961.649408 0 1361.641813 0C1361.641813 0 1432.688811 3.997201 1432.688811 97.881301L771.345323 681.472759C771.345323 681.472759 764.482731 685.154773 753.594283 688.65053L753.594283 688.664858C741.602731 693.493018 729.424896 695.068979 718.077952 694.839748 706.731093 695.068979 694.553173 693.493018 682.561621 688.664858L682.561621 688.65053C671.644501 685.140446 664.781909 681.472759 664.781909 681.472759L664.781909 681.472759ZM718.063616 811.603883C693.779541 811.016482 658.879232 802.205449 619.10784 767.734955 542.989056 701.759633 0 212.052267 0 212.052267L0 942.809523C0 942.809523 0 1024 83.726336 1024L682.532949 1024 753.579947 1024 1348.948139 1024C1432.688811 1024 1432.688811 942.809523 1432.688811 942.809523L1432.688811 212.052267C1432.688811 212.052267 893.138176 701.759633 817.019477 767.734955 777.248 802.205449 742.347691 811.03081 718.063616 811.603883L718.063616 811.603883Z"></path>
</svg>

    </a>
  
    <a href="https://twitter.com/Haier0715" rel="me noopener" class="iconfont"
      title="twitter"  target="_blank"
      >
      <svg class="icon" viewBox="0 0 1264 1024" version="1.1"
  xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"
  width="36" height="36">
  <path d="M1229.8616 18.043658c0 0-117.852626 63.135335-164.151872 67.344358-105.225559-164.151872-505.082682-92.598492-437.738325 223.078185C278.622548 312.675223 89.216542 47.506814 89.216542 47.506814s-117.852626 189.406006 75.762402 345.139833C127.097743 396.85567 55.544363 371.601535 55.544363 371.601535S26.081207 535.753407 253.368414 615.724832c-21.045112 29.463156-113.643603 8.418045-113.643603 8.418045s25.254134 143.10676 231.496229 180.987961c-143.10676 130.479693-387.230056 92.598492-370.393967 105.225559 206.242095 189.406006 1119.599946 231.496229 1128.01799-643.98042C1179.353331 249.539887 1263.533778 123.269217 1263.533778 123.269217s-130.479693 37.881201-138.897738 33.672179C1225.652577 98.015083 1229.8616 18.043658 1229.8616 18.043658"></path>
</svg>

    </a>
  
    <a href="https://github.com/fengzixu" rel="me noopener" class="iconfont"
      title="github"  target="_blank"
      >
      <svg class="icon" style="" viewBox="0 0 1024 1024" version="1.1"
  xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"
  width="36" height="36">
  <path d="M512 12.672c-282.88 0-512 229.248-512 512 0 226.261333 146.688 418.133333 350.08 485.76 25.6 4.821333 34.986667-11.008 34.986667-24.618667 0-12.16-0.426667-44.373333-0.64-87.04-142.421333 30.890667-172.458667-68.693333-172.458667-68.693333C188.672 770.986667 155.008 755.2 155.008 755.2c-46.378667-31.744 3.584-31.104 3.584-31.104 51.413333 3.584 78.421333 52.736 78.421333 52.736 45.653333 78.293333 119.850667 55.68 149.12 42.581333 4.608-33.109333 17.792-55.68 32.426667-68.48-113.706667-12.8-233.216-56.832-233.216-253.013333 0-55.893333 19.84-101.546667 52.693333-137.386667-5.76-12.928-23.04-64.981333 4.48-135.509333 0 0 42.88-13.738667 140.8 52.48 40.96-11.392 84.48-17.024 128-17.28 43.52 0.256 87.04 5.888 128 17.28 97.28-66.218667 140.16-52.48 140.16-52.48 27.52 70.528 10.24 122.581333 5.12 135.509333 32.64 35.84 52.48 81.493333 52.48 137.386667 0 196.693333-119.68 240-233.6 252.586667 17.92 15.36 34.56 46.762667 34.56 94.72 0 68.522667-0.64 123.562667-0.64 140.202666 0 13.44 8.96 29.44 35.2 24.32C877.44 942.592 1024 750.592 1024 524.672c0-282.752-229.248-512-512-512"></path>
</svg>

    </a>


<a href="http://littledriver.net/index.xml" rel="noopener alternate" type="application/rss&#43;xml"
    class="iconfont" title="rss" target="_blank">
    <svg class="icon" viewBox="0 0 1024 1024" version="1.1"
  xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"
  width="30" height="30">
  <path d="M819.157333 1024C819.157333 574.592 449.408 204.8 0 204.8V0c561.706667 0 1024 462.293333 1024 1024h-204.842667zM140.416 743.04a140.8 140.8 0 0 1 140.501333 140.586667A140.928 140.928 0 0 1 140.074667 1024C62.72 1024 0 961.109333 0 883.626667s62.933333-140.544 140.416-140.586667zM678.784 1024h-199.04c0-263.210667-216.533333-479.786667-479.744-479.786667V345.173333c372.352 0 678.784 306.517333 678.784 678.826667z"></path>
</svg>

  </a>
  
</div>

<div class="copyright">
  <span class="power-by">
    Powered by <a class="hexo-link" href="https://gohugo.io">Hugo</a>
  </span>
  <span class="division">|</span>
  <span class="theme-info">
    Theme - <a class="theme-link" href="https://github.com/xianmin/hugo-theme-jane">Jane</a>
  </span>

  <span class="copyright-year">
    &copy;
    
       -
    2018
    <span class="heart">
      
      <i class="iconfont">
        <svg class="icon" viewBox="0 0 1025 1024" version="1.1"
  xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"
  width="14" height="14">
  <path d="M1000.1 247.9c-15.5-37.3-37.6-70.6-65.7-98.9-54.4-54.8-125.8-85-201-85-85.7 0-166 39-221.4 107.4C456.6 103 376.3 64 290.6 64c-75.1 0-146.5 30.4-201.1 85.6-28.2 28.5-50.4 61.9-65.8 99.3-16 38.8-24 79.9-23.6 122.2 0.7 91.7 40.1 177.2 108.1 234.8 3.1 2.6 6 5.1 8.9 7.8 14.9 13.4 58 52.8 112.6 102.7 93.5 85.5 209.9 191.9 257.5 234.2 7 6.1 15.8 9.5 24.9 9.5 9.2 0 18.1-3.4 24.9-9.5 34.5-30.7 105.8-95.9 181.4-165 74.2-67.8 150.9-138 195.8-178.2 69.5-57.9 109.6-144.4 109.9-237.3 0.1-42.5-8-83.6-24-122.2z"
   fill="#8a8a8a"></path>
</svg>

      </i>
    </span><span class="author">
        xuran
        
      </span></span>

  
  
</div>

    </footer>

    <div class="back-to-top" id="back-to-top">
      <i class="iconfont">
        
        <svg class="icon" viewBox="0 0 1024 1024" version="1.1"
  xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"
  width="35" height="35">
  <path d="M510.866688 227.694839 95.449397 629.218702l235.761562 0-2.057869 328.796468 362.40389 0L691.55698 628.188232l241.942331-3.089361L510.866688 227.694839zM63.840492 63.962777l894.052392 0 0 131.813095L63.840492 195.775872 63.840492 63.962777 63.840492 63.962777zM63.840492 63.962777"></path>
</svg>

      </i>
    </div>
  </div>
  
<script type="text/javascript" src="/lib/jquery/jquery-3.2.1.min.js"></script>
  <script type="text/javascript" src="/lib/slideout/slideout-1.0.1.min.js"></script>




<script type="text/javascript" src="/js/main.638251f4230630f0335d8c6748e53a96f94b72670920b60c09a56fdc8bece214.js" integrity="sha256-Y4JR9CMGMPAzXYxnSOU6lvlLcmcJILYMCaVv3Ivs4hQ="></script>














  <script id="dsq-count-scr" src="//fengzixu.disqus.com/count.js" async></script>





</body>
</html>
